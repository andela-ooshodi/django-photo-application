language: python
python:
- '2.7'
env:
- DJANGO_SETTINGS_MODULE=djangophotoapp.settings.test
install:
- pip install --upgrade pip
- pip install --upgrade virtualenv
- pip install -r requirements.txt
- pip install coveralls
- npm install bower
script:
- bower install --settings=djangophotoapp.settings.test
- python djangophotoapp/manage.py collectstatic --noinput --settings=djangophotoapp.settings.test
- coverage run --source=photoapp djangophotoapp/manage.py test
after_success:
- coveralls
deploy:
  provider: heroku
  buildpack:
    - node
    - python
  api_key:
    secure: NqhyImUKqxHq8zMvPjbJKEBTDJN3QzrmyLFnYIdE90sAML1C6NdpyA139ZtgEWWLksoVtWfZhy7r736F95F1iir8MIFuRoUdZ/s4RHxY0iZXLe0HUlt3HULv2tIKk5CifS10jIh7jTk/f68YzA+t4rGcS4T4I759z0ja14D20LGGV8fj/HKiFaiY5mBrNZd6TvDPyfvQ2fBtjcXFnkEkCdikzK9rn4+eqIToLxHXUGSZXEyvjykwqATveGcnkZITXHgrBM9dLkBHfwxC6f78Vlq+gr2GPHaXRp4Lw+VhWfzjKyszL8CQ0SN+D40F30HsJc3VwlNTgzhxgH6oXfQpDbWV6ttYu/Nl3joF0bzznXnh33hUvB+vOVHtw0fXN3vr60snQPu202SqDPoJpYkqu84Fya14hr0s5xj/ZoD8iNqbWlpGb5gq5hJnZ2lT0/wzYsVk2IABcfUftciJvIguKn57al33/Ou/XBQ1wnwNvW7y+mXNsmg4vspb9dONZiTRqz8xoVaz3bNIQKKQ7BDZ8o7YltzB9AazXgufK/Nj7wg4dlJGCpx400diDAJS5KgfsRt1XFo1gCyIrZ94vNC071QrPQu1hXPNq3jUXyVC4FNyPOi+92Nyrra2sTfwM2j4drJ2kiYpKECNFaZ7wKgfZbm+SReheZPVv85Ly19HC+k=
  app: myphotoapp-staging
  on:
    repo: andela-ooshodi/django-photo-application
  run:
  - export DJANGO_SETTINGS_MODULE=djangophotoapp.settings.production
  - python djangophotoapp/manage.py collectstatic --noinput
  - python djangophotoapp/manage.py makemigrations
  - python djangophotoapp/manage.py migrate