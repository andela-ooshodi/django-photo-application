language: python
python:
- '2.7'
env:
- DJANGO_SETTINGS_MODULE=djangophotoapp.settings.test
install:
- pip install --upgrade pip
- pip install --upgrade virtualenv
- pip install -r requirements.txt
- pip install coveralls
- npm install bower
script:
- bower install --settings=djangophotoapp.settings.test
- python djangophotoapp/manage.py collectstatic --noinput --settings=djangophotoapp.settings.test
- coverage run --source=photoapp djangophotoapp/manage.py test
after_success:
- coveralls
deploy:
  provider: heroku
  buildpack:
    - node
    - python
  api_key:
    secure: rfPAZV4se0u4dHofrxod1cC8svllXnrdsWHu4+CrhI19dV8EJ4vFVJ8/LlNWtcoHMy5aBTfVM0+iqUvRxagrlp+vtT7dhL1EddXErFeYTvxWtvKPa5wBTXhSip9h9IRlMf4gNQ1wCpAagDQPXZgX0fnleOfY/qDnqk9H3/H+W4CqKUnQD+nJkm3F8dV8v1SchWm6OJJCEU86G0TB/SeFXKhH89CZ6Pt5YVpQrredz9KpVTWCDjhexIP3O0CjmNwfvi6KFGifE8tfTJ3OMYdX8ruhlf7NOgISFzI8BkpOK/exs1jMDWxQnQBGG6HnnfX3qdaKhNUKpas8ep+lmwJEQ2olWM0Kj3+lMm9wr2ggbYlHib+d82J6s0RL8JzkwR6Brg0FCz8W64+aNBJc/Za2W4hAh0I2lKPrjQ0vn+SemsFsLGwtXenIL402nAzQlG+rL0EvAvHmt/aHAOsJiyIaBtt3klMrp/deRWZxZiLJ/VeCRXRTxMgwFvpuGZURYjPww2iw0ay2ZVSsHF2fdyrdYbd9q9vO464PzQ1tRSSFr0ja0LHPEMCfJcc1IF3XoH+rzCYVN3RlB9Z2Z6hp2h8QVkfDJrzHL7GzWevLPcOiIQaM3mlKA75CeiC2UcahbB8yp/IvpFz/6uP1skw4+fe6tx8Em3clKOWaaULshKaa2wA=
  app: myphotoapplication
  on:
    repo: andela-ooshodi/django-photo-application
  run:
    - export DJANGO_SETTINGS_MODULE=djangophotoapp.settings.production
    - python djangophotoapp/manage.py collectstatic --noinput
    - python djangophotoapp/manage.py makemigrations
    - python djangophotoapp/manage.py migrate
