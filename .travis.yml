language: python
python:
- '2.7'
env:
- DJANGO_SETTINGS_MODULE=djangophotoapp.settings.test
install:
- pip install --upgrade pip
- pip install --upgrade virtualenv
- pip install -r requirements.txt
- pip install coveralls
- npm install bower
script:
- bower install --settings=djangophotoapp.settings.test
- python djangophotoapp/manage.py collectstatic --noinput --settings=djangophotoapp.settings.test
- coverage run --source=photoapp djangophotoapp/manage.py test
after_success:
- coveralls
deploy:
  provider: heroku
  buildpack:
  - node
  - python
  api_key:
    secure: Lwij2oEafdN9dPstvIwjtP65gEBkLKH5QBzZXV2sP7egUiCpYtuPxw603F+z9RqymUQPAU1iYCYwa076jwAwFxPOdGPI6LMOEI1Q1oKFuINV/XsjE6Ke6ZnyxnXMZ8s8VkR/37yQLcZXEw5dPzck7Wi9aIiyk0GqPW181jrzU8XyMoHhAHWUG8rpQGUFJEe+livgJaO1nmw+dCdlGP1qT8Pz1gkBEibABiRO56uV823BG/RaX5NawuVubZlbrZ9zfObwX+++XudWEQLLpjdXsMRcN/LPT2UXoyA5BbrTwhvEQ2JYU9oWVRhaV0yLUJJIqgR2FhVvJs0E2RbiAdcfXyVMK1MtA0RhoTGAd5tTLzeFOqSrPD/hPrfWExPiTCYOeTtJz6Gb9JOW112LS5b6jR9VZOVlh39Ud2UfBJefOAKYmhcGhokvlfQnviu++Wl0hkKKQ3o/v4JW3dfWJ+TuKFksIrFJuXvwAiLdy2gkKp+8JvzqUFan+ThR8pyOUizkL3aqir6ygJYUvPAUq7AEQiVwmVJ8rGK6HvhqUjTOFTKbVcTj2jp6icEpUYTzXSuUY8c6yoDyVp0C0R9nHUNd1mCOxBisdyzoXbGciZs1S4zJyf1Nt44ZHHxf3j7z4l3Ht9mtWP8s87Jg6SjmO+GagVSto0WiJYsPy+Rr8cEdtVA=
  app: myphotoapp-staging
  on:
    repo: andela-ooshodi/django-photo-application
  run:
  - export DJANGO_SETTINGS_MODULE=djangophotoapp.settings.production
  - python djangophotoapp/manage.py collectstatic --noinput
  - python djangophotoapp/manage.py makemigrations
  - python djangophotoapp/manage.py migrate
